# 技术设计: 对话框图片模式可用性保护

## 技术方案
### 核心技术
- React + TypeScript
- 前端状态：`useAIChatStore` / `AIChatDialog`

### 实现要点
- 在 `AIChatDialog` 里计算当前有效图片数量（融合优先，其次单图编辑/分析）。
- 维护“模式可用性”判断函数：`auto` 不限制；`edit/analyze` 仅允许 1 张；`blend` 允许 ≥2 张；`text/generate/vector` 仅允许 0 张；`video` 允许 0-1 张。
- 当 `manualAIMode` 与当前图片数量不匹配时，自动切换为 `auto`。
- 下拉模式选项基于可用性禁用并展示提示信息。
- 发送按钮禁用条件加入模式可用性校验，tooltip 显示“当前模式不支持 N 张图”。
- 发送逻辑入口再进行一次校验，必要时给出 toast 提示。

## 安全与性能
- **安全:** 纯前端状态控制，不涉及外部输入。
- **性能:** 仅新增轻量级 `useMemo` / `useEffect` 计算，无显著影响。

## 测试与部署
- **测试:** 手动验证：单图/多图切换、模式下拉禁用、发送按钮提示与禁用状态。
- **部署:** 无额外流程，随前端构建发布。
