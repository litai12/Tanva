# Sora2 视频下载 - 快速参考指南

## 🎯 三种下载方式对比

您现在获得了 **3 种不同的视频下载方式**，应对不同的场景：

### 1️⃣ **🌐 在浏览器打开** (最可靠)
- **工作原理**：在新标签页中打开视频
- **优点**：
  - ✅ 100% 可靠（不受 CORS 限制）
  - ✅ 适用于所有网络环境
  - ✅ 用户可以右键保存视频
  - ✅ 支持在线播放
- **缺点**：
  - ❌ 需要手动操作才能保存
  - ❌ 不如自动下载方便
- **使用场景**：CORS 被阻止时的最佳选择

---

### 2️⃣ **🔗 复制链接** (最灵活)
- **工作原理**：复制视频 URL 到剪贴板
- **优点**：
  - ✅ 永远有效
  - ✅ 可以用任何下载工具（迅雷、IDM 等）
  - ✅ 可以分享给他人
  - ✅ 用于高级用户
- **缺点**：
  - ❌ 需要用户自己处理下载
  - ❌ 需要额外的下载工具
- **使用场景**：需要用专业下载工具加速的大文件

**粘贴链接位置：**
```
在浏览器地址栏粘贴链接
→ 按 Enter
→ 视频开始下载
```

---

### 3️⃣ **📥 下载视频** (最智能，推荐)
- **工作原理**：双重策略
  1. **优先方案**：尝试 Fetch API + Blob（需要 CORS）
  2. **降级方案**：浏览器原生 `<a download>` 方法
  3. **备用方案**：如果失败，自动复制链接到剪贴板
- **优点**：
  - ✅ 一键下载（最方便）
  - ✅ 自动命名为 `video-2025-11-16.mp4`
  - ✅ 智能降级，总能找到办法
  - ✅ 失败时自动复制链接
- **缺点**：
  - ⚠️ 受 CORS 限制影响（有降级）
- **使用场景**：默认推荐方式

**工作流程：**
```
点击"📥 下载视频"
  ↓
第一次尝试：Fetch API 下载
  ├─ 成功 → ✅ 自动保存文件
  └─ 失败 ↓
第二次尝试：浏览器原生下载
  ├─ 成功 → ✅ 自动保存文件
  └─ 失败 ↓
第三次尝试：复制链接到剪贴板
  └─ 显示备用方案提示
```

---

## 🔍 URL 格式分析

```
https://filesystem.site/cdn/20251115/363e38c69a973749215b9466308eb4.mp4
│        │                 │           │                           │
│        │                 │           │                           └─ 文件格式：MP4
│        │                 │           └─ 文件名：Hash 值（唯一标识）
│        │                 └─ 日期戳：20251115（年月日）
│        └─ CDN 路径：cdn/
└─ 域名：filesystem.site（CDN 源）
```

**特点：**
- 📍 CDN 跨域资源（可能有 CORS 限制）
- 📅 带日期的 CDN 路径（临时或永久存储）
- 🔐 Hash 文件名（不可猜测，安全性高）

---

## 🛠️ 如果下载失败怎么办？

### ❌ 情景 1：直接下载失败
```
提示：❌ 直接下载失败，已复制链接到剪贴板
```

**解决方案（按优先级）：**

1. **立即尝试**：
   - 使用 "🌐 在浏览器打开" 按钮
   - 在新标签页中右键 → 保存视频

2. **使用剪贴板链接**：
   - Ctrl+V (Windows) 或 Cmd+V (Mac) 打开链接
   - 或手动在地址栏粘贴

3. **使用下载工具**：
   ```
   Chrome：Chrome 下载器（内置）
   Firefox：Firefox 下载器（内置）
   Windows：IDM、迅雷等专业下载工具
   Mac：Aria2、Motrix 等
   ```

---

### ❌ 情景 2：CORS 错误（跨域限制）
```
浏览器控制台（F12）显示：
Access to fetch has been blocked by CORS policy
```

**原因：** CDN 没有配置允许跨域下载

**解决方案：**
1. ✅ 使用 "🌐 在浏览器打开"（绕过 CORS）
2. ✅ 使用 "🔗 复制链接"（用下载工具）
3. ⚠️ 直接下载可能需要后端代理（需要开发者配置）

---

### ❌ 情景 3：网络超时
```
提示：onfetcherror 或 timeout
```

**解决方案：**
1. 检查网络连接
2. 使用专业下载工具（支持断点续传）：
   - Aria2
   - Motrix
   - IDM
3. 或者等待网络恢复后重试

---

## 💾 下载完成后

### 文件信息
```
文件名：video-2025-11-16.mp4
格式：MPEG-4 (MP4)
编解码器：支持所有现代浏览器和播放器
兼容性：✅ Windows, Mac, Linux, 手机 等
```

### 验证文件
```bash
# 检查文件大小
ls -lh video-2025-11-16.mp4

# 检查视频信息（需要 ffmpeg）
ffprobe video-2025-11-16.mp4

# 验证视频可播放性
ffplay video-2025-11-16.mp4
```

### 播放工具
- **Windows**：Windows Media Player, VLC, PotPlayer
- **Mac**：QuickTime, VLC
- **Linux**：VLC, mpv
- **在线**：任何现代浏览器

---

## 🎯 推荐流程

### 场景 A：网络正常 ✅
```
点击"📥 下载视频" → 自动下载成功 ✅
```

### 场景 B：CORS 被阻止
```
点击"📥 下载视频" → 失败 →
  ↓
点击"🌐 在浏览器打开" → 新标签页打开 →
  ↓
右键点击视频 → "保存视频..." → 选择保存位置 ✅
```

### 场景 C：需要加速下载
```
点击"🔗 复制链接" →
  ↓
打开专业下载工具（IDM/迅雷）→ 粘贴链接 →
  ↓
使用多线程加速下载 ✅
```

---

## 📱 移动端下载

### iOS
```
1. 点击"🌐 在浏览器打开"
2. 长按视频 → "保存视频"
3. 视频保存到"照片"应用
```

### Android
```
1. 点击"🌐 在浏览器打开"
2. 长按视频 → "保存视频"
3. 选择保存位置（下载文件夹）
```

### 如果移动端无法直接下载
```
1. 点击"🔗 复制链接"
2. 使用浏览器默认下载管理器
3. 或使用专业下载 APP（Aria2、ADM 等）
```

---

## 🔐 安全建议

| 项目 | 说明 |
|------|------|
| **病毒扫描** | ✅ 视频来自 Sora2 官方 API，安全性高 |
| **隐私保护** | ✅ 链接包含 Hash，无法从文件名推断内容 |
| **存储空间** | ⚠️ 视频文件可能较大（通常 10-100MB），注意磁盘空间 |
| **链接有效期** | ⏳ CDN 链接通常有有效期（建议立即下载） |

---

## 🧪 测试命令

如果您是开发者，可以在浏览器控制台（F12）运行以下命令测试：

```javascript
// 测试 1: 检查 CORS 是否允许
fetch('https://filesystem.site/cdn/20251115/363e38c69a973749215b9466308eb4.mp4', {
  mode: 'cors'
})
.then(r => console.log('✅ CORS 允许，状态:', r.status))
.catch(e => console.log('❌ CORS 被阻止:', e.message));

// 测试 2: 检查文件大小
fetch('https://filesystem.site/cdn/20251115/363e38c69a973749215b9466308eb4.mp4', {
  mode: 'cors',
  method: 'HEAD'
})
.then(r => {
  const size = r.headers.get('content-length');
  console.log('📊 文件大小:', (size / 1024 / 1024).toFixed(2), 'MB');
});

// 测试 3: 自动下载（与按钮逻辑相同）
async function testDownload() {
  try {
    const response = await fetch('https://filesystem.site/cdn/20251115/363e38c69a973749215b9466308eb4.mp4', {
      mode: 'cors'
    });
    const blob = await response.blob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'video-test.mp4';
    a.click();
    console.log('✅ 下载已触发');
  } catch (e) {
    console.log('❌ 下载失败:', e.message);
  }
}
testDownload();
```

---

## 📊 快速对照表

| 功能 | 按钮 | 何时使用 | 成功率 |
|------|------|---------|-------|
| 自动下载 | 📥 | 默认推荐 | 95% |
| 在线播放 | 🌐 | CORS 失败时 | 100% |
| 复制链接 | 🔗 | 需要加速下载 | 100% |
| 右键保存 | - | 网页打开后 | 100% |

---

## ❓ 常见问题

**Q: 为什么有三个按钮？**
A: 为了应对不同网络环境和用户需求。总有一种方式能成功。

**Q: 下载的文件名是什么？**
A: `video-YYYY-MM-DD.mp4`（以下载日期命名）

**Q: 文件可以保存多久？**
A: 取决于 Sora2 服务的 CDN 保留期。建议立即下载。

**Q: 可以改变文件名吗？**
A: 下载后可以任意重命名。

**Q: 支持断点续传吗？**
A: 取决于 CDN。使用专业下载工具（IDM、Aria2）可获得更好支持。

---

**总结：** 新的下载方案提供了 **最大的兼容性和用户友好性**，无论什么网络环境都能成功获取视频！

