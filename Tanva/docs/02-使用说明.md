# 使用说明（面向当前系统）

本指南覆盖 Tanva 当前版本从环境配置、启动到核心功能的使用方法，并指向相关专题文档。

## 环境要求

- Node.js 18+
- npm 9+
- 现代浏览器（建议 Chrome/Edge 最新版）

## 环境配置

1) 复制并填写前端环境变量

- 基于 `.env.local.example` 创建 `.env.local`，至少设置：
  - `VITE_GOOGLE_GEMINI_API_KEY`：你的 Gemini API Key
  - `VITE_AUTH_MODE=server`：与后端联通时建议使用 `server`
  - 其余变量按注释需求选择性填写

2) 配置后端环境变量（见 `server/README.md` 与 `docs/Server-后端功能说明.md`）

- 复制 `server/.env.example` 为 `server/.env`，填写数据库、JWT、Cookie、CORS、OSS 等字段。

## 启动项目

1) 启动后端（NestJS + Prisma）

```bash
cd server
npm install
npm run dev
```

默认监听 `http://localhost:4000`，Swagger 文档在 `/api/docs`。

2) 启动前端（React + Vite）

```bash
npm install
npm run dev
```

默认监听 `http://localhost:5173`。

## 登录与工作台

- 访问根路径 `/`，从右上角进入“登录 / 注册”。
- 登录成功后，前端会加载“我的工作”（`/workspace`）。
- 点击“新建项目”创建后将跳转到工作界面 `/app?projectId=...`。

相关专题：`docs/17-认证与项目系统.md`

## 画布与工具

- 画布基于 Paper.js，支持缩放、平移、图层管理与多种绘图工具。
- 工具栏与面板位于工作界面，可进行文本、图形、图像与 3D 模型操作。
- 自动保存与手动保存：右上角会显示保存状态，必要时可手动触发保存。

相关专题：
- `docs/09-画布系统技术文档.md`
- `docs/11-工具列系统技术文档.md`
- `docs/18-自动保存与版本管理.md`

## AI 能力

- 支持文本生成图像、图像编辑/融合、图像分析与上下文对话。
- AI 对话入口位于工作界面（聊天模式/节点模式）。
- 提示词优化 Demo：在地址后添加 `?prompt-demo` 或访问首页后进入调试。

相关专题：
- `docs/04-AI系统文档.md`
- `docs/14-Gemini-API文档.md`
- `docs/20-提示词优化功能说明.md`

## 资源与上传（OSS）

- 支持阿里云 OSS 直传与 JSON 读写。
- 演示页：`/oss`
- 需在服务端与 `.env.local` 中正确配置 OSS 参数。

相关专题：`docs/19-OSS上传与资源管理.md`

## 3D 模型

- 支持 GLB/GLTF 上传与预览，提供基础交互与容器组件。

相关专题：`docs/12-3D系统技术文档.md`

## 图像历史与放置策略

- 记录生成/编辑/融合历史，支持中心点智能放置与调试面板。

相关专题：`docs/21-图像历史与缓存系统.md`

## 常见问题

- 401 未授权：后端采用 Cookie 模式，若过期会自动刷新；若仍失败请重新登录。
- Cookie 域名：本地开发不应设置为 `localhost` 域，后端已做兼容处理。
- Gemini Key：未配置将无法调用生成能力（部分模块带有回退/警告）。

## 快捷入口

- 工作台：`/workspace`
- 画布应用：`/app?projectId=...`
- 登录：`/auth/login`，注册：`/auth/register`
- OSS 演示：`/oss`
- 提示词优化 Demo：`/app?prompt-demo`

