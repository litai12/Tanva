# Changelog

All notable changes to this project are documented here.

This file follows the Keep a Changelog style, and the project aims to use Semantic Versioning.

## [Unreleased]

### Added
- 前端使用说明文档重写（docs/02-使用说明.md）
- 新增专题文档：
  - 认证与项目系统（docs/17-认证与项目系统.md）
  - 自动保存与版本管理（docs/18-自动保存与版本管理.md）
  - OSS 上传与资源管理（docs/19-OSS上传与资源管理.md）
  - 提示词优化功能说明（docs/20-提示词优化功能说明.md）
  - 图像历史与缓存系统（docs/21-图像历史与缓存系统.md）

### Changed
- README 更新：增加后端启动、文档导航与能力清单
- Flow：Image Split 分割改为运行时 `canvas/flow-asset`（Split 时不再强制上传 OSS）；保存链路会自动补传并将 `inputImageUrl` 替换为远程 URL/OSS key；Image Grid 支持基于 `splitRects` 裁切拼合并输出上传后的 OSS key/URL。

### Fixed
- Flow：视频节点参考图按连线解析，支持 Image Split 切片作为输入。
- Flow：Image Split 生成的 Image 节点（`crop` 预览）在下游运行时会按裁切结果传参，避免仍使用完整原图。
- Flow：修复 Image Split 切片在下游裁切/拼合时分辨率被压缩（例如 base 图像只加载到缩略图时 1024 误变 200），并降低边缘白边概率。
- 前端图片转码：新增全局并发限流（暂定 10），收口图片生成/转化（`canvas.toDataURL/toBlob`、`FileReader.readAsDataURL`、`Response.blob`、`createImageBitmap/WebCodecs` 等）并在 AI Chat/Flow/画布等链路复用，降低多图场景瞬时内存峰值与卡顿风险。

### Notes
- 以上文档与当前代码库保持一致，后续联调或接口变化请同步更新

## [v0.1.0] - 2025-09-16

### Added
- Center-based smart placement for new images:
  - `generate`: place new image to the right by 522px from cached center.
  - `edit`: place new image below by 522px from cached center.
- Cached image debug panel (`CachedImageDebug`): shows cached image ID, prompt, preview, center `(cx, cy)`, and latest mode (`generate|edit|blend|analyze|chat`).
- Event-driven updates:
  - `cachedImageChanged` fired when cache updates or clears.
  - `contextModeChanged` fired when recording an operation (mode change).
- Context cache extended with `latestBounds` and `latestLayerId`.
- When an image is placed on canvas or selected, cache is updated with its latest bounds.

### Changed
- Quick upload flow now accepts `smartPosition` and prioritizes it for precise placement.

### Notes
- If no cached position exists, the first image falls back to the default center `(0, 0)`.
- Layer info is optional for placement; calculations use the center point from bounds.

[v0.1.0]: https://github.com/litai12/Tanva/releases/tag/v0.1.0
